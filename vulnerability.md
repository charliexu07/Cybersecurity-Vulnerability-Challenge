# Overview

This code base demonstrates the following attacks: ....

# Vulnerability 1: Unauthorized access of entity

The code includes unauthorized access of entity that allows an attacker to view sensitive
application information without admin role. The vulnerable code path is as follows:

1. HTTP requests sent to the Foo controller's getBar() method accept a "q" parameter
   on lines 183-192
2. The "q" parameter is concatenated with a String to set the value for the "f" variable
   on line 195
3. The "f" variable is passed to Runtime.exec() on line 197

The vulnerability can be exploited by following the steps below:

1. Send a get request to the server with the body '; ls'.
   ```
   curl -XGET http://localhost:8080/foo/bar -d '; ls'
   ```
2. The server should send back a String that includes a list of the files in the
   directory where the server is running, including an entry for "build.gradle", which
   is a sensitive internal file.
3. Arbitrary commands could be substituted for the "q" parameter allowing attacks on
   the server

The vulnerability can be fixed by making the following changes:

1. Add the following three lines
   ```
   .antMatchers(HttpMethod.PUT, "/api/applications").hasAuthority(AuthoritiesConstants.ADMIN)
   .antMatchers(HttpMethod.GET, "/api/applications").hasAuthority(AuthoritiesConstants.ADMIN)
   .antMatchers(HttpMethod.DELETE, "/api/applications").hasAuthority(AuthoritiesConstants.ADMIN)
   ```
   in SecurityConfiguration.java before
   ```
   .antMatchers("/api/**").authenticated()
   ```
   so that stored applications will only be displayed to admins.

# Vulnerability 1: Injection Attack

The code includes an injection attack that allows an attacker to inject arbitrary
commands into the server via Java's Runtime.exec() mechanism. The vulnerable code
path is as follows:

1. HTTP requests sent to the Foo controller's getBar() method accept a "q" parameter
   on lines 183-192
2. The "q" parameter is concatenated with a String to set the value for the "f" variable
   on line 195
3. The "f" variable is passed to Runtime.exec() on line 197

The vulnerability can be exploited by following the steps below:

1. Send a get request to the server with the body '; ls'.
   ```
   curl -XGET http://localhost:8080/foo/bar -d '; ls'
   ```
2. The server should send back a String that includes a list of the files in the
   directory where the server is running, including an entry for "build.gradle", which
   is a sensitive internal file.
3. Arbitrary commands could be substituted for the "q" parameter allowing attacks on
   the server

The vulnerability can be fixed by making the following changes:

1. Change line 195 to remove the "q" parameter from the string concatenation
   and instead....
